<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>JSON Parsing</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:500&display=swap" rel="stylesheet">

  <style>
    html {
      font-family: 'Montserrat', sans-serif;
    }
    .thumb {
      height: 75px;
      border: 1px solid #000;
      margin: 10px 5px 0 0;
    }
    table {
      border: 1;
    }

  </style>
</head>

<body>

  <h2>Create a Table from JSON Data</h2>

  <select id="myselect">
    <option value="">Choose a department:</option>
    <option value='mathcs'>Math / Computer Science</option>
    <option value='music'>Music</option>
    <option value='physics'>Physics</option>
  </select>

  <input type="search">
  <input type="button" id="goButton" name="goButton" value="Go!" onclick="change_myselect()">

  <p id="demo"></p>

  <script>
    /** Not going to lie, this is a pretty hacky implementation, but it works. A better implementation would probably use JQuery. */
    function readJsonFile(file, callback) {
      var rawFile = new XMLHttpRequest();
      rawFile.responseType = 'json'
      rawFile.overrideMimeType("application/json");
      rawFile.open("GET", file, true);
      rawFile.onreadystatechange = function() {
        if (rawFile.readyState === 4 && rawFile.status == "200") {
          callback(rawFile.response);
        }
      }
      rawFile.send(null);
    }
    function change_myselect() {
      var dbParam, data, x, txt = "";
      sel = document.getElementById("myselect").value;
      data = window.jsondata;
      depts = Object.keys(data.department);
      console.log(depts);
      txt += "<table border='1'>";
      if(sel) {
        for(y in depts) {
          console.log(y);
          for (x in data.department[y]) {
            txt += "<tr><td>" + data.department[y][x].name + "</td>";
            txt += "<td>" + data.department[y][x].email + "</td>";
            txt += "<td>" + data.department[y][x].phone + "</td></tr>";
          }
        }
      } else {
        for (x in data.department[sel]) {
          txt += "<tr><td>" + data.department[sel][x].name + "</td>";
          txt += "<td>" + data.department[sel][x].email + "</td>";
          txt += "<td>" + data.department[sel][x].phone + "</td></tr>";
        }
      }
      txt += "</table>";
      document.getElementById("demo").innerHTML = txt;
    }

    readJsonFile("professors.json", function(data) {
      window.jsondata = data;
      console.log(data);
    });

  </script>

</body>

</html>
